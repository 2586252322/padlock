<polymer-element name="safe-app">
    <template>
        <style>
            :host {
                font-family: Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;
                position: absolute;
                left: 0;
                right: 0;
                bottom: 0;
                top: 0;
                margin: auto;
                font-weight: 300;
                font-size: 18px;
                color: #333;
                -webkit-user-select: none;     
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                -webkit-tap-highlight-color: transparent;

            }

            .view {
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                margin: auto;
                overflow: scroll;
                -webkit-overflow-scrolling: touch;
            }

            .list-header {
                padding: 8px;
                background: rgb(245, 245, 245);
                display: -webkit-box;
                -webkit-box-align: center;
            }

            .list-header > input {
                border: none;
                font-family: inherit;
                font-size: inherit;
                font-weight: inherit;
                -webkit-appearance: none;
                padding: 6px;
                display: block;
                -webkit-box-flex: 1;
                background: white;
                border-radius: 2px;
                margin: 0;
            }

            .list-header > button {
                display: block;
                border: none;
                background: transparent;
                font-size: 30px;
                font-family: inherit;
                font-weight: 100;
                line-height: 15px;
                color: #000;
                margin-left: 8px;
            }

            ::-webkit-search-cancel-button {
                display: none;
            }

            *:focus {
                outline: none;
            }
        </style>
        <div class="view" id="list" on-scroll="{{ scroll }}" on-touchmove="{{ drag }}">
            <div id="listHeader" class="list-header">
                <input value="{{ filterString }}" type="search" placeholder="type to filter..." />
                <button on-click="{{ addRecord }}">+</button>
            </div>
            <template repeat="{{ record, i in filteredRecords}}">
                <safe-record-item record="{{ record }}" on-click="{{ recordClicked }}" index="{{ i }}"></safe-record-item>
            </template>
        </div>
        <safe-record-view id="detail" on-back="{{ back }}" style="display: none;"></safe-record-view>
    </template>
    <script>
        Polymer("safe-app", {
            ready: function() {
                this.records = [
                    {name: "First", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Second", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Third", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Fourth", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Fifth", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Sixth", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Seventh", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Eight", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Nine", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Ten", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Eleven", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Twelve", fields: [
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"},
                        {name: "myfield", value: "test"},
                        {name: "another field", value: "Hello World!"}
                    ]},
                    {name: "Thirteen"},
                    {name: "Fourteen"},
                    {name: "Fiveteen"},
                    {name: "Sexteen"},
                    {name: "Seventeen"},
                    {name: "Eighteen"},
                    {name: "Nineteen"},
                    {name: "Twenty"},
                    {name: "Twenty One"},
                    {name: "Twenty Two"},
                    {name: "Twenty Three"},
                    {name: "Twenty Four"},
                    {name: "Twenty Five"},
                    {name: "Twenty Six"},
                    {name: "Twenty Eight"},
                    {name: "Twenty Nine"},
                    {name: "Thirty"},
                    {name: "Thirty One"},
                    {name: "Thirty Two"},
                    {name: "Thirty Three"},
                    {name: "Thirty Four"},
                    {name: "Thirty Five"},
                ];
                this.filteredRecords = this.records;
            },
            recordClicked: function(event, detail, sender) {
                this.openRecord(sender.templateInstance.model.record);
            },
            openRecord: function(record) {
                this.$.detail.record = record;
                this.$.list.style.display = "none";
                this.$.detail.style.display = "block";
            },
            back: function(event, detail, sender) {
                this.$.detail.style.display = "none";
                this.$.list.style.display = "block";
            },
            filterStringChanged: function(oldVal, newVal) {
                this.filteredRecords = newVal ? this.records.filter(function(rec) {
                    return rec.name.toLowerCase().search(newVal.toLowerCase()) != -1;
                }) : this.records;
            },
            addRecord: function() {
                var record = {
                    name: "",
                    fields: []
                };
                this.records.push(record);
                this.openRecord(record);
            }
        });
    </script>
</polymer-element>