<link rel="import" href="../../padlock.html">
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../dialog/dialog.html">
<link rel="import" href="../view/view.html">
<link rel="import" href="../markable-behavior/markable-behavior.html">
<link rel="import" href="../input/input.html">
<link rel="import" href="../notification/notification.html">
<link rel="import" href="../toggle/toggle.html">

<dom-module id="padlock-record-view">

    <link href="record-view.css" rel="import" type="css">

    <template>
        <div class$="{{ _categoryClass(record.category) }}" on-tap="_openCategories">{{ _categoryLabel(record.category) }}</div>
        <!-- FIELD LIST -->
        <template is="dom-repeat" items="{{ record.fields }}">
            <div class="field" on-tap="_fieldTapped" on-mouseover="_fieldMouseover" on-mouseout="_fieldMouseout">
                <div class="value" hidden$="{{ _isObfuscated(index, _revealedFields.*, settings.obfuscate_fields) }}">{{ item.value }}</div>
                <div class="value obfuscated" hidden$="{{ !_isObfuscated(index, _revealedFields.*, settings.obfuscate_fields) }}">{{ _obfuscate(item.value) }}</div>
                <div class="label">{{ item.name }}</div>
            </div>
        </template>
        <button class="add-button" on-tap="_addField">Add Field</button>
        <!-- RECORD OPTIONS -->
        <padlock-dialog id="menu">
            <button on-tap="_editName">Edit Name</button>
            <button on-tap="_deleteRecord" id="confirmButton">Delete Record</button>
            <button class="toggle" on-tap="_toggleObfuscate">
                <span>Obfuscate Fields</span>
                <padlock-toggle value="{{ settings.obfuscate_fields }}" notap></padlock-toggle>
            </button>
        </padlock-dialog>
        <!-- DELETE CONFIRM DIALOG -->
        <padlock-dialog id="confirmDeleteDialog">
            <div class="title">Are you sure you want to delete this record?</div>
            <button class="primary" on-tap="_confirmDelete">Delete</button>
            <button on-tap="_cancelDelete">Cancel</button>
        </padlock-dialog>
        <!-- EDIT NAME DIALOG -->
        <padlock-dialog id="editNameDialog">
            <div class="title">Edit Name</div>
            <input is="padlock-input" id="nameInput" select-all-on-focus placeholder="Enter Record Name"/>
            <button class="primary" on-tap="_confirmEditName">Save</button>
        </padlock-dialog>
        <!-- FIELD CONTEXT MENU -->
        <padlock-dialog id="fieldMenu" on-close="_fieldDialogClosed">
            <button on-tap="copyToClipboard">Copy to Clipboard</button>
            <button on-tap="_editField">Edit</button>
            <button on-tap="_removeField">Remove</button>
        </padlock-dialog>
        <!-- EDIT FIELD DIALOG -->
        <padlock-dialog id="editFieldDialog" on-close="_fieldDialogClosed">
            <div class="title">Edit '<strong>{{ _selectedField.name }}</strong>'</div>
            <input is="padlock-input" id="fieldValueInput" select-all-on-focus placeholder="Enter Content" />
            <button on-tap="_generateValue">Generate</button>
            <button class="primary" on-tap="_confirmEditField">Save Changes</button>
        </padlock-dialog>
        <!-- ADD FIELD DIALOG -->
        <padlock-dialog id="addFieldDialog">
            <div class="title">Add Field</div>
            <input is="padlock-input" id="newFieldNameInput" placeholder="Enter Label" />
            <input is="padlock-input" id="newValueInput" placeholder="Enter Content" />
            <button on-tap="_generateValue">Generate</button>
            <button class="primary" on-tap="_confirmAddField">Add</button>
        </padlock-dialog>
        <!-- REMOVE FIELD CONFIRM DIALOG -->
        <padlock-dialog id="confirmRemoveFieldDialog" on-close="_fieldDialogClosed">
            <div class="title">Are you sure you want to remove this field?</div>
            <button class="primary" on-tap="_confirmRemoveField">Remove</button>
            <button on-tap="_cancelRemoveField">Cancel</button>
        </padlock-dialog>

        <padlock-notification id="notification"></padlock-notification>

        <array-selector id="selector" items="{{ record.fields }}" selected="{{ _selectedField }}"></array-selector>
    </template>
    <script src="record-view.js"></script>
</dom-module>
