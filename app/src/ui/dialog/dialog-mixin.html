<link rel="import" href="../base/base.html">
<link rel="import" href="dialog-alert.html">
<link rel="import" href="dialog-confirm.html">
<link rel="import" href="dialog-prompt.html">

<script>
(() => {

const { wait } = padlock.util;

let alertDialog, confirmDialog, promptDialog;
let lastDialogPromise = Promise.resolve();

padlock.DialogMixin = (superClass) => {

    return class DialogMixin extends superClass {

        alert(message, buttonLabel) {
            if (!alertDialog) {
                alertDialog = document.createElement("pl-dialog-alert");
                document.body.appendChild(alertDialog);
            }
            lastDialogPromise = lastDialogPromise
                .then(() => alertDialog.alert(message, buttonLabel))
                .then(() => wait(500));
            return lastDialogPromise;
        }

        confirm(message, confirmLabel, cancelLabel) {
            if (!confirmDialog) {
                confirmDialog = document.createElement("pl-dialog-confirm");
                document.body.appendChild(confirmDialog);
            }
            lastDialogPromise = lastDialogPromise
                .then(() => confirmDialog.confirm(message, confirmLabel, cancelLabel))
                .then(() => wait(500));
            return lastDialogPromise;
        }

        prompt(message, type, confirmLabel, cancelLabel) {
            if (!promptDialog) {
                promptDialog = document.createElement("pl-dialog-prompt");
                document.body.appendChild(promptDialog);
            }
            lastDialogPromise = lastDialogPromise
                .then(() => promptDialog.prompt(message, type, confirmLabel, cancelLabel))
                .then(() => wait(500));
            return lastDialogPromise;
        }

    };
};

})();
</script>
