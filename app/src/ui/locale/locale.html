<link rel="import" href="../base/base.html">

<script>
(() => {

padlock.translations = {
    "de": {
        "Unlock": "Entsperren"
    }
};

const translations = padlock.translations;

function resolveLanguage(locale) {
    const localeParts = locale.toLowerCase().split("-");

    while (localeParts.length) {
        const l = localeParts.join("-");
        if (translations[l]) {
            return l;
        }

        localeParts.pop();
    }
}

const locale = navigator.language || navigator.browserLanguage || "en";
const language = resolveLanguage(locale);

function localize(msg, ...fmtArgs) {
    const lang = translations[language];
    let res = lang && lang[msg] || msg;

    for (let i = 0; i < fmtArgs.length; i++) {
        res = res.replace(new RegExp(`\\{${i}\\}`), fmtArgs[i]);
    }

    return res;
}

padlock.LocaleMixin = (superClass) => {

    return class LocaleMixin extends superClass {

        $l() {
            return localize.apply(arguments);
        }

    };
};

window.$l = localize;

})();
</script>
